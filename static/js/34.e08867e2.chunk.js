(this["webpackJsonpkhaos-frontend"]=this["webpackJsonpkhaos-frontend"]||[]).push([[34],{1041:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(25),a=r(24);function s(e,t){Object(a.a)(2,arguments);var r=Object(n.default)(e),s=Object(n.default)(t);return r.getTime()-s.getTime()}},1042:function(e,t,r){var n=r(459);e.exports=function(e,t){return n(e,t)}},1356:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(274),a=r(275),s=r(25),i=r(24),o=r(37);function u(e,t){if(Object(i.a)(2,arguments),!t||"object"!==typeof t)return new Date(NaN);var r="years"in t?Object(o.a)(t.years):0,u="months"in t?Object(o.a)(t.months):0,l="weeks"in t?Object(o.a)(t.weeks):0,c="days"in t?Object(o.a)(t.days):0,f="hours"in t?Object(o.a)(t.hours):0,h="minutes"in t?Object(o.a)(t.minutes):0,p="seconds"in t?Object(o.a)(t.seconds):0,m=Object(s.default)(e),g=u||r?Object(a.default)(m,u+12*r):m,d=c||l?Object(n.default)(g,c+7*l):g,v=h+60*f,b=p+60*v,y=1e3*b,x=new Date(d.getTime()+y);return x}},1357:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1041),a=r(24),s=36e5;function i(e,t){Object(a.a)(2,arguments);var r=Object(n.a)(e,t)/s;return r>0?Math.floor(r):Math.ceil(r)}},1536:function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n=r(1),a=r.n(n);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t.indexOf(r=s[n])>=0||(a[r]=e[r]);return a}function o(e){var t=Object(n.useRef)(e),r=Object(n.useRef)((function(e){t.current&&t.current(e)}));return t.current=e,r.current}var u=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e<t?t:e},l=function(e){return"touches"in e},c=function(e,t){var r=e.getBoundingClientRect(),n=l(t)?t.touches[0]:t;return{left:u((n.pageX-(r.left+window.pageXOffset))/r.width),top:u((n.pageY-(r.top+window.pageYOffset))/r.height)}},f=function(e){!l(e)&&e.preventDefault()},h=a.a.memo((function(e){var t=e.onMove,r=e.onKey,u=i(e,["onMove","onKey"]),h=Object(n.useRef)(null),p=o(t),m=o(r),g=Object(n.useRef)(!1),d=Object(n.useMemo)((function(){var e=function(e){f(e),(l(e)?e.touches.length>0:e.buttons>0)&&h.current?p(c(h.current,e)):r(!1)},t=function(){return r(!1)};function r(r){var n=g.current,a=r?self.addEventListener:self.removeEventListener;a(n?"touchmove":"mousemove",e),a(n?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,n=h.current;n&&(f(t),!function(e,t){return t&&!l(e)}(t,g.current)&&n&&(g.current=l(t),n.focus(),p(c(n,t)),r(!0)))},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),m({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},r]}),[m,p]),v=d[0],b=d[1],y=d[2];return Object(n.useEffect)((function(){return y}),[y]),a.a.createElement("div",s({},u,{onTouchStart:v,onMouseDown:v,className:"react-colorful__interactive",ref:h,onKeyDown:b,tabIndex:0,role:"slider"}))})),p=function(e){return e.filter(Boolean).join(" ")},m=function(e){var t=e.color,r=e.left,n=e.top,s=void 0===n?.5:n,i=p(["react-colorful__pointer",e.className]);return a.a.createElement("div",{className:i,style:{top:100*s+"%",left:100*r+"%"}},a.a.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},g=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r},d=(Math.PI,function(e){return"#"===e[0]&&(e=e.substr(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:1}:{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:1}}),v=function(e){var t=e.s,r=e.v,n=e.a,a=(200-t)*r/100;return{h:g(e.h),s:g(a>0&&a<200?t*r/100/(a<=100?a:200-a)*100:0),l:g(a/2),a:g(n,2)}},b=function(e){var t=v(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},y=function(e){var t=e.h,r=e.s,n=e.v,a=e.a;t=t/360*6,r/=100,n/=100;var s=Math.floor(t),i=n*(1-r),o=n*(1-(t-s)*r),u=n*(1-(1-t+s)*r),l=s%6;return{r:g(255*[n,o,i,i,u,n][l]),g:g(255*[u,n,n,o,i,i][l]),b:g(255*[i,i,u,n,n,o][l]),a:g(a,2)}},x=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},w=function(e){var t=e.r,r=e.g,n=e.b,a=e.a,s=Math.max(t,r,n),i=s-Math.min(t,r,n),o=i?s===t?(r-n)/i:s===r?2+(n-t)/i:4+(t-r)/i:0;return{h:g(60*(o<0?o+6:o)),s:g(s?i/s*100:0),v:g(s/255*100),a:a}},T=a.a.memo((function(e){var t=e.hue,r=e.onChange,n=p(["react-colorful__hue",e.className]);return a.a.createElement("div",{className:n},a.a.createElement(h,{onMove:function(e){r({h:360*e.left})},onKey:function(e){r({h:u(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuetext":g(t)},a.a.createElement(m,{className:"react-colorful__hue-pointer",left:t/360,color:b({h:t,s:100,v:100,a:1})})))})),M=a.a.memo((function(e){var t=e.hsva,r=e.onChange,n={backgroundColor:b({h:t.h,s:100,v:100,a:1})};return a.a.createElement("div",{className:"react-colorful__saturation",style:n},a.a.createElement(h,{onMove:function(e){r({s:100*e.left,v:100-100*e.top})},onKey:function(e){r({s:u(t.s+100*e.left,0,100),v:u(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+g(t.s)+"%, Brightness "+g(t.v)+"%"},a.a.createElement(m,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:b(t)})))})),E=function(e,t){if(e===t)return!0;for(var r in e)if(e[r]!==t[r])return!1;return!0};function k(e,t,r){var a=o(r),s=Object(n.useState)((function(){return e.toHsva(t)})),i=s[0],u=s[1],l=Object(n.useRef)({color:t,hsva:i});Object(n.useEffect)((function(){if(!e.equal(t,l.current.color)){var r=e.toHsva(t);l.current={hsva:r,color:t},u(r)}}),[t,e]),Object(n.useEffect)((function(){var t;E(i,l.current.hsva)||e.equal(t=e.fromHsva(i),l.current.color)||(l.current={hsva:i,color:t},a(t))}),[i,e,a]);var c=Object(n.useCallback)((function(e){u((function(t){return Object.assign({},t,e)}))}),[]);return[i,c]}var O,A,I="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,_=function(){I((function(){if("undefined"!=typeof document&&!A){(A=document.createElement("style")).innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}';var e=O||r.nc;e&&A.setAttribute("nonce",e),document.head.appendChild(A)}}),[])},L=function(e){var t=e.className,r=e.colorModel,n=e.color,o=void 0===n?r.defaultColor:n,u=e.onChange,l=i(e,["className","colorModel","color","onChange"]);_();var c=k(r,o,u),f=c[0],h=c[1],m=p(["react-colorful",t]);return a.a.createElement("div",s({},l,{className:m}),a.a.createElement(M,{hsva:f,onChange:h}),a.a.createElement(T,{hue:f.h,onChange:h,className:"react-colorful__last-control"}))},S={defaultColor:"000",toHsva:function(e){return w(d(e))},fromHsva:function(e){return r=(t=y(e)).g,n=t.b,"#"+x(t.r)+x(r)+x(n);var t,r,n},equal:function(e,t){return e.toLowerCase()===t.toLowerCase()||E(d(e),d(t))}},N=function(e){return a.a.createElement(L,s({},e,{colorModel:S}))}},1541:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12),a=r(15),s=r(995),i=function(){function e(){Object(n.a)(this,e),this.pluginCallbacks=[],this.register((function(e){return new j(e)})),this.register((function(e){return new C(e)})),this.register((function(e){return new F(e)})),this.register((function(e){return new U(e)})),this.register((function(e){return new z(e)}))}return Object(a.a)(e,[{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,r){for(var n=new R,a=[],s=0,i=this.pluginCallbacks.length;s<i;s++)a.push(this.pluginCallbacks[s](n));n.setPlugins(a),n.write(e,t,r)}}]),e}(),o=0,u=1,l=2,c=3,f=4,h=5121,p=5123,m=5126,g=5125,d=34962,v=34963,b=9728,y=9729,x=9984,w=9985,T=9986,M=9987,E=33071,k=33648,O=10497,A={};A[s.NearestFilter]=b,A[s.NearestMipmapNearestFilter]=x,A[s.NearestMipmapLinearFilter]=T,A[s.LinearFilter]=y,A[s.LinearMipmapNearestFilter]=w,A[s.LinearMipmapLinearFilter]=M,A[s.ClampToEdgeWrapping]=E,A[s.RepeatWrapping]=O,A[s.MirroredRepeatWrapping]=k;var I={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function _(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}function L(e){return 4*Math.ceil(e/4)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=L(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var a=e.byteLength;a<r;a++)n[a]=t;return n.buffer}return e}var N=null,R=function(){function e(){Object(n.a)(this,e),this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}return Object(a.a)(e,[{key:"setPlugins",value:function(e){this.plugins=e}},{key:"write",value:function(e,t,r){this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e);var n=this;Promise.all(this.pending).then((function(){var e=n.buffers,r=n.json,a=n.options,s=n.extensionsUsed,i=new Blob(e,{type:"application/octet-stream"}),o=Object.keys(s);if(o.length>0&&(r.extensionsUsed=o),r.buffers&&r.buffers.length>0&&(r.buffers[0].byteLength=i.size),!0===a.binary){var u=new window.FileReader;u.readAsArrayBuffer(i),u.onloadend=function(){var e=S(u.result),n=new DataView(new ArrayBuffer(8));n.setUint32(0,e.byteLength,!0),n.setUint32(4,5130562,!0);var a=S(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var a=e.charCodeAt(r);t[r]=a>255?32:a}return t.buffer}(JSON.stringify(r)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,a.byteLength,!0),s.setUint32(4,1313821514,!0);var i=new ArrayBuffer(12),o=new DataView(i);o.setUint32(0,1179937895,!0),o.setUint32(4,2,!0);var l=12+s.byteLength+a.byteLength+n.byteLength+e.byteLength;o.setUint32(8,l,!0);var c=new Blob([i,s,a,n,e],{type:"application/octet-stream"}),f=new window.FileReader;f.readAsArrayBuffer(c),f.onloadend=function(){t(f.result)}}}else if(r.buffers&&r.buffers.length>0){var l=new window.FileReader;l.readAsDataURL(i),l.onloadend=function(){var e=l.result;r.buffers[0].uri=e,t(r)}}else t(r)}))}},{key:"serializeUserData",value:function(e,t){if(0!==Object.keys(e.userData).length){var r=this.options,n=this.extensionsUsed;try{var a=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&a.gltfExtensions){for(var s in void 0===t.extensions&&(t.extensions={}),a.gltfExtensions)t.extensions[s]=a.gltfExtensions[s],n[s]=!0;delete a.gltfExtensions}Object.keys(a).length>0&&(t.extras=a)}catch(i){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+i.message)}}}},{key:"getUID",value:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)}},{key:"isNormalizedNormalAttribute",value:function(e){if(this.cache.attributesNormalized.has(e))return!1;for(var t=new s.Vector3,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}},{key:"createNormalizedNormalAttribute",value:function(e){var t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);for(var r=e.clone(),n=new s.Vector3,a=0,i=r.count;a<i;a++)n.fromBufferAttribute(r,a),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),r.setXYZ(a,n.x,n.y,n.z);return t.attributesNormalized.set(e,r),r}},{key:"applyTextureTransform",value:function(e,t){var r=!1,n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(n.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,this.extensionsUsed.KHR_texture_transform=!0)}},{key:"processBuffer",value:function(e){var t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0}},{key:"processBufferView",value:function(e,t,r,n,a){var s,i=this.json;i.bufferViews||(i.bufferViews=[]),s=t===h?1:t===p?2:4;for(var o=L(n*e.itemSize*s),u=new DataView(new ArrayBuffer(o)),l=0,c=r;c<r+n;c++)for(var f=0;f<e.itemSize;f++){var v=void 0;e.itemSize>4?v=e.array[c*e.itemSize+f]:0===f?v=e.getX(c):1===f?v=e.getY(c):2===f?v=e.getZ(c):3===f&&(v=e.getW(c)),t===m?u.setFloat32(l,v,!0):t===g?u.setUint32(l,v,!0):t===p?u.setUint16(l,v,!0):t===h&&u.setUint8(l,v),l+=s}var b={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:o};return void 0!==a&&(b.target=a),a===d&&(b.byteStride=e.itemSize*s),this.byteOffset+=o,i.bufferViews.push(b),{id:i.bufferViews.length-1,byteLength:0}}},{key:"processBufferViewImage",value:function(e){var t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise((function(n){var a=new window.FileReader;a.readAsArrayBuffer(e),a.onloadend=function(){var e=S(a.result),s={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,n(r.bufferViews.push(s)-1)}}))}},{key:"processAccessor",value:function(e,t,r,n){var a,s=this.options,i=this.json;if(e.array.constructor===Float32Array)a=m;else if(e.array.constructor===Uint32Array)a=g;else if(e.array.constructor===Uint16Array)a=p;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");a=h}if(void 0===r&&(r=0),void 0===n&&(n=e.count),s.truncateDrawRange&&void 0!==t&&null===t.index){var o=r+n,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;r=Math.max(r,t.drawRange.start),(n=Math.min(o,u)-r)<0&&(n=0)}if(0===n)return null;var l,c=function(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},a=t;a<t+r;a++)for(var s=0;s<e.itemSize;s++){var i=void 0;e.itemSize>4?i=e.array[a*e.itemSize+s]:0===s?i=e.getX(a):1===s?i=e.getY(a):2===s?i=e.getZ(a):3===s&&(i=e.getW(a)),n.min[s]=Math.min(n.min[s],i),n.max[s]=Math.max(n.max[s],i)}return n}(e,r,n);void 0!==t&&(l=e===t.index?v:d);var f=this.processBufferView(e,a,r,n,l),b={bufferView:f.id,byteOffset:f.byteOffset,componentType:a,count:n,max:c.max,min:c.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(b.normalized=!0),i.accessors||(i.accessors=[]),i.accessors.push(b)-1}},{key:"processImage",value:function(e,t,r){var n=this,a=n.cache,i=n.json,o=n.options,u=n.pending;a.images.has(e)||a.images.set(e,{});var l=a.images.get(e),c=t===s.RGBAFormat?"image/png":"image/jpeg",f=c+":flipY/"+r.toString();if(void 0!==l[f])return l[f];i.images||(i.images=[]);var h={mimeType:c};if(o.embedImages){var p=N=N||document.createElement("canvas");p.width=Math.min(e.width,o.maxTextureSize),p.height=Math.min(e.height,o.maxTextureSize);var m=p.getContext("2d");if(!0===r&&(m.translate(0,p.height),m.scale(1,-1)),"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap)m.drawImage(e,0,0,p.width,p.height);else{t!==s.RGBAFormat&&t!==s.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>o.maxTextureSize||e.height>o.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);var g=new Uint8ClampedArray(e.height*e.width*4);if(t===s.RGBAFormat)for(var d=0;d<g.length;d+=4)g[d+0]=e.data[d+0],g[d+1]=e.data[d+1],g[d+2]=e.data[d+2],g[d+3]=e.data[d+3];else for(var v=0,b=0;v<g.length;v+=4,b+=3)g[v+0]=e.data[b+0],g[v+1]=e.data[b+1],g[v+2]=e.data[b+2],g[v+3]=255;m.putImageData(new ImageData(g,e.width,e.height),0,0)}!0===o.binary?u.push(new Promise((function(e){p.toBlob((function(t){n.processBufferViewImage(t).then((function(t){h.bufferView=t,e()}))}),c)}))):h.uri=p.toDataURL(c)}else h.uri=e.src;var y=i.images.push(h)-1;return l[f]=y,y}},{key:"processSampler",value:function(e){var t=this.json;t.samplers||(t.samplers=[]);var r={magFilter:A[e.magFilter],minFilter:A[e.minFilter],wrapS:A[e.wrapS],wrapT:A[e.wrapT]};return t.samplers.push(r)-1}},{key:"processTexture",value:function(e){var t=this.cache,r=this.json;if(t.textures.has(e))return t.textures.get(e);r.textures||(r.textures=[]);var n={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(n.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,n)}));var a=r.textures.push(n)-1;return t.textures.set(e,a),a}},{key:"processMaterial",value:function(e){var t=this.cache,r=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);var n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var a=e.color.toArray().concat([e.opacity]);if(_(a,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=a),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var i={index:this.processTexture(e.metalnessMap)};this.applyTextureTransform(i,e.metalnessMap),n.pbrMetallicRoughness.metallicRoughnessTexture=i}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:this.processTexture(e.map)};this.applyTextureTransform(o,e.map),n.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){var u=e.emissive.clone().multiplyScalar(e.emissiveIntensity),l=Math.max(u.r,u.g,u.b);if(l>1&&(u.multiplyScalar(1/l),console.warn("THREE.GLTFExporter: Some emissive components exceed 1; emissive has been limited")),l>0&&(n.emissiveFactor=u.toArray()),e.emissiveMap){var c={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(c,e.emissiveMap),n.emissiveTexture=c}}if(e.normalMap){var f={index:this.processTexture(e.normalMap)};e.normalScale&&1!==e.normalScale.x&&(f.scale=e.normalScale.x),this.applyTextureTransform(f,e.normalMap),n.normalTexture=f}if(e.aoMap){var h={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(h.strength=e.aoMapIntensity),this.applyTextureTransform(h,e.aoMap),n.occlusionTexture=h}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===s.DoubleSide&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,n)}));var p=r.materials.push(n)-1;return t.materials.set(e,p),p}},{key:"processMesh",value:function(e){var t=this.cache,r=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(var a=0,i=e.material.length;a<i;a++)n.push(e.material[a].uuid);else n.push(e.material.uuid);var h=n.join(":");if(t.meshes.has(h))return t.meshes.get(h);var p,m=e.geometry;if(p=e.isLineSegments?u:e.isLineLoop?l:e.isLine?c:e.isPoints?o:e.material.wireframe?u:f,!0!==m.isBufferGeometry)throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");var g={},d={},v=[],b=[],y={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},x=m.getAttribute("normal");void 0===x||this.isNormalizedNormalAttribute(x)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),m.setAttribute("normal",this.createNormalizedNormalAttribute(x)));var w=null;for(var T in m.attributes)if("morph"!==T.substr(0,5)){var M=m.attributes[T];T=y[T]||T.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(T)||(T="_"+T),t.attributes.has(this.getUID(M)))d[T]=t.attributes.get(this.getUID(M));else{w=null;var E=M.array;"JOINTS_0"!==T||E instanceof Uint16Array||E instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),w=new s.BufferAttribute(new Uint16Array(E),M.itemSize,M.normalized));var k=this.processAccessor(w||M,m);null!==k&&(d[T]=k,t.attributes.set(this.getUID(M),k))}}if(void 0!==x&&m.setAttribute("normal",x),0===Object.keys(d).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var O=[],A=[],I={};if(void 0!==e.morphTargetDictionary)for(var _ in e.morphTargetDictionary)I[e.morphTargetDictionary[_]]=_;for(var L=0;L<e.morphTargetInfluences.length;++L){var S={},N=!1;for(var R in m.morphAttributes)if("position"===R||"normal"===R){var j=m.morphAttributes[R][L],C=R.toUpperCase(),F=m.attributes[R];if(t.attributes.has(this.getUID(j)))S[C]=t.attributes.get(this.getUID(j));else{var U=j.clone();if(!m.morphTargetsRelative)for(var z=0,B=j.count;z<B;z++)U.setXYZ(z,j.getX(z)-F.getX(z),j.getY(z)-F.getY(z),j.getZ(z)-F.getZ(z));S[C]=this.processAccessor(U,m),t.attributes.set(this.getUID(F),S[C])}}else N||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),N=!0);b.push(S),O.push(e.morphTargetInfluences[L]),void 0!==e.morphTargetDictionary&&A.push(I[L])}g.weights=O,A.length>0&&(g.extras={},g.extras.targetNames=A)}var D=Array.isArray(e.material);if(D&&0===m.groups.length)return null;for(var G=D?e.material:[e.material],H=D?m.groups:[{materialIndex:0,start:void 0,count:void 0}],V=0,P=H.length;V<P;V++){var K={mode:p,attributes:d};if(this.serializeUserData(m,K),b.length>0&&(K.targets=b),null!==m.index){var X=this.getUID(m.index);void 0===H[V].start&&void 0===H[V].count||(X+=":"+H[V].start+":"+H[V].count),t.attributes.has(X)?K.indices=t.attributes.get(X):(K.indices=this.processAccessor(m.index,m,H[V].start,H[V].count),t.attributes.set(X,K.indices)),null===K.indices&&delete K.indices}var Y=this.processMaterial(G[H[V].materialIndex]);null!==Y&&(K.material=Y),v.push(K)}g.primitives=v,r.meshes||(r.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,g)}));var J=r.meshes.push(g)-1;return t.meshes.set(h,J),J}},{key:"processCamera",value:function(e){var t=this.json;t.cameras||(t.cameras=[]);var r=e.isOrthographicCamera,n={type:r?"orthographic":"perspective"};return r?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:s.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),t.cameras.push(n)-1}},{key:"processAnimation",value:function(e,t){var r=this.json,n=this.nodeMap;r.animations||(r.animations=[]);for(var a=(e=i.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],u=[],l=0;l<a.length;++l){var c=a[l],f=s.PropertyBinding.parseTrackName(c.name),h=s.PropertyBinding.findNode(t,f.nodeName),p=I[f.propertyName];if("bones"===f.objectName&&(h=!0===h.isSkinnedMesh?h.skeleton.getBoneByName(f.objectIndex):void 0),!h||!p)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',c.name),null;var m=c.values.length/c.times.length;p===I.morphTargetInfluences&&(m/=h.morphTargetInfluences.length);var g=void 0;!0===c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(g="CUBICSPLINE",m/=3):g=c.getInterpolation()===s.InterpolateDiscrete?"STEP":"LINEAR",u.push({input:this.processAccessor(new s.BufferAttribute(c.times,1)),output:this.processAccessor(new s.BufferAttribute(c.values,m)),interpolation:g}),o.push({sampler:u.length-1,target:{node:n.get(h),path:p}})}return r.animations.push({name:e.name||"clip_"+r.animations.length,samplers:u,channels:o}),r.animations.length-1}},{key:"processSkin",value:function(e){var t=this.json,r=this.nodeMap,n=t.nodes[r.get(e)],a=e.skeleton;if(void 0===a)return null;var i=e.skeleton.bones[0];if(void 0===i)return null;for(var o=[],u=new Float32Array(16*a.bones.length),l=new s.Matrix4,c=0;c<a.bones.length;++c)o.push(r.get(a.bones[c])),l.copy(a.boneInverses[c]),l.multiply(e.bindMatrix).toArray(u,16*c);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new s.BufferAttribute(u,16)),joints:o,skeleton:r.get(i)}),n.skin=t.skins.length-1}},{key:"processNode",value:function(e){var t=this.json,r=this.options,n=this.nodeMap;t.nodes||(t.nodes=[]);var a={};if(r.trs){var s=e.quaternion.toArray(),i=e.position.toArray(),o=e.scale.toArray();_(s,[0,0,0,1])||(a.rotation=s),_(i,[0,0,0])||(a.translation=i),_(o,[1,1,1])||(a.scale=o)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===_(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(a.matrix=e.matrix.elements);if(""!==e.name&&(a.name=String(e.name)),this.serializeUserData(e,a),e.isMesh||e.isLine||e.isPoints){var u=this.processMesh(e);null!==u&&(a.mesh=u)}else e.isCamera&&(a.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){for(var l=[],c=0,f=e.children.length;c<f;c++){var h=e.children[c];if(h.visible||!1===r.onlyVisible){var p=this.processNode(h);null!==p&&l.push(p)}}l.length>0&&(a.children=l)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,a)}));var m=t.nodes.push(a)-1;return n.set(e,m),m}},{key:"processScene",value:function(e){var t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);var n={};""!==e.name&&(n.name=e.name),t.scenes.push(n);for(var a=[],s=0,i=e.children.length;s<i;s++){var o=e.children[s];if(o.visible||!1===r.onlyVisible){var u=this.processNode(o);null!==u&&a.push(u)}}a.length>0&&(n.nodes=a),this.serializeUserData(e,n)}},{key:"processObjects",value:function(e){var t=new s.Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);this.processScene(t)}},{key:"processInput",value:function(e){var t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));for(var r=[],n=0;n<e.length;n++)e[n]instanceof s.Scene?this.processScene(e[n]):r.push(e[n]);r.length>0&&this.processObjects(r);for(var a=0;a<this.skins.length;++a)this.processSkin(this.skins[a]);for(var i=0;i<t.animations.length;++i)this.processAnimation(t.animations[i],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}},{key:"_invokeAll",value:function(e){for(var t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}}]),e}(),j=function(){function e(t){Object(n.a)(this,e),this.writer=t,this.name="KHR_lights_punctual"}return Object(a.a)(e,[{key:"writeNode",value:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var r=this.writer,n=r.json,a=r.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,s.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),a[this.name]||(n.extensions=n.extensions||{},n.extensions[this.name]={lights:[]},a[this.name]=!0);var i=n.extensions[this.name].lights;i.push(s),t.extensions=t.extensions||{},t.extensions[this.name]={light:i.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}}]),e}(),C=function(){function e(t){Object(n.a)(this,e),this.writer=t,this.name="KHR_materials_unlit"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshBasicMaterial){var r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}}]),e}(),F=function(){function e(t){Object(n.a)(this,e),this.writer=t,this.name="KHR_materials_pbrSpecularGlossiness"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var r=this.writer,n=r.extensionsUsed,a={};t.pbrMetallicRoughness.baseColorFactor&&(a.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var s=[1,1,1];if(e.specular.toArray(s,0),a.specularFactor=s,a.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(a.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var i={index:r.processTexture(e.specularMap)};r.applyTextureTransform(i,e.specularMap),a.specularGlossinessTexture=i}t.extensions=t.extensions||{},t.extensions[this.name]=a,n[this.name]=!0}}}]),e}(),U=function(){function e(t){Object(n.a)(this,e),this.writer=t,this.name="KHR_materials_transmission"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshPhysicalMaterial&&0!==e.transmission){var r=this.writer,n=r.extensionsUsed,a={};if(a.transmissionFactor=e.transmission,e.transmissionMap){var s={index:r.processTexture(e.transmissionMap)};r.applyTextureTransform(s,e.transmissionMap),a.transmissionTexture=s}t.extensions=t.extensions||{},t.extensions[this.name]=a,n[this.name]=!0}}}]),e}(),z=function(){function e(t){Object(n.a)(this,e),this.writer=t,this.name="KHR_materials_volume"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshPhysicalMaterial&&0!==e.thickness){var r=this.writer,n=r.extensionsUsed,a={};if(a.thicknessFactor=e.thickness,e.thicknessMap){var s={index:r.processTexture(e.thicknessMap)};r.applyTextureTransform(s,e.thicknessMap),a.thicknessTexture=s}a.attenuationDistance=e.attenuationDistance,a.attenuationColor=e.attenuationTint.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=a,n[this.name]=!0}}}]),e}();i.Utils={insertKeyframe:function(e,t){var r,n=.001,a=e.getValueSize(),s=new e.TimeBufferType(e.times.length+1),i=new e.ValueBufferType(e.values.length+a),o=e.createInterpolant(new e.ValueBufferType(a));if(0===e.times.length){s[0]=t;for(var u=0;u<a;u++)i[u]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<n)return 0;s[0]=t,s.set(e.times,1),i.set(o.evaluate(t),0),i.set(e.values,a),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<n)return e.times.length-1;s[s.length-1]=t,s.set(e.times,0),i.set(e.values,0),i.set(o.evaluate(t),e.values.length),r=s.length-1}else for(var l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<n)return l;if(e.times[l]<t&&e.times[l+1]>t){s.set(e.times.slice(0,l+1),0),s[l+1]=t,s.set(e.times.slice(l+1),l+2),i.set(e.values.slice(0,(l+1)*a),0),i.set(o.evaluate(t),(l+1)*a),i.set(e.values.slice((l+1)*a),(l+2)*a),r=l+1;break}}return e.times=s,e.values=i,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},a=e.tracks,i=0;i<a.length;++i){var o=a[i],u=s.PropertyBinding.parseTrackName(o.name),l=s.PropertyBinding.findNode(t,u.nodeName);if("morphTargetInfluences"===u.propertyName&&void 0!==u.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(s.InterpolateLinear)}var c=l.morphTargetInfluences.length,f=l.morphTargetDictionary[u.propertyIndex];if(void 0===f)throw new Error("THREE.GLTFExporter: Morph target name not found: "+u.propertyIndex);var h=void 0;if(void 0!==n[l.uuid]){var p=o.createInterpolant(new o.ValueBufferType(1));h=n[l.uuid];for(var m=0;m<h.times.length;m++)h.values[m*c+f]=p.evaluate(h.times[m]);for(var g=0;g<o.times.length;g++){var d=this.insertKeyframe(h,o.times[g]);h.values[d*c+f]=o.values[g]}}else{for(var v=new((h=o.clone()).ValueBufferType)(c*h.times.length),b=0;b<h.times.length;b++)v[b*c+f]=h.values[b];h.name=(u.nodeName||"")+".morphTargetInfluences",h.values=v,n[l.uuid]=h,r.push(h)}}else r.push(o)}return e.tracks=r,e}}}}]);
//# sourceMappingURL=34.e08867e2.chunk.js.map